#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -e

GETTEXT_VERSION=0.19.3
GETTEXT_SRC_TARBALL=http://ftp.gnu.org/pub/gnu/gettext/gettext-$GETTEXT_VERSION.tar.xz
TARGET_DIR=$HOME
BUILD_DIR=$1
CACHE_DIR=$2

cd $BUILD_DIR

if [ -d $TARGET_DIR/gettext ]; then
	echo "$PWD/gettext already installed"
	exit 0
fi

echo "-----> Installing gettext..."
echo $GETTEXT_SRC_TARBALL
curl --silent --max-time 60 --location "$GETTEXT_SRC_TARBALL" | tar x
cd gettext-$GETTEXT_VERSION
cd gettext-tools
./configure --prefix=$TARGET_DIR/gettext --enable-static --disable-shared
make
make install
echo "-----> done in $TARGET_DIR/gettext"
